# HAProxyReduce 配置

# ------------------------------------------------------------------
# 1. 黑名单模式开关
# ------------------------------------------------------------------
# 打开后（true）：
#   · list.conf中定义的 IP/段 不被允许连接（黑名单模式）
#   · soft-whitelist 设置项失效
#   · 除list.conf内定义的ip范围以外皆允许连接
#
# 关闭时（false，默认）：
#   · list.conf中定义的 IP/段 为白名单
#   · 配合 soft-whitelist 设置项决定「名单外是否允许连接」
# ------------------------------------------------------------------
disable-whitelist: false

# ------------------------------------------------------------------
# 2. 软白名单开关（只在disable-whitelist: false时有效）
# ------------------------------------------------------------------
# 打开时（true，默认）：
#   · 不管在不在名单，**连接都放行**；
#   · list.conf中定义的 IP/段名单外只允许直接普通 TCP连接，不支持protocol协议
#
# 关闭时（false）：
#   · 只有 list.conf中定义的 IP/段 能连，其余直接 TCP 层级拒收
# ------------------------------------------------------------------
soft-whitelist: true

# ------------------------------------------------------------------
# 3. 自动协议完成开关（嗅探 HAProxy 头）
# ------------------------------------------------------------------
# 打开时（true，默认）：
#   · 对「有资格解析」的连接（见下表）先读 12 字节；
#   · 发现 HAProxy 头 → 自动套官方解码器；
#   · 发现不是 → 重置指针，当纯 TCP 跑。
#
# 关闭时（false）：
#   · 对「有资格解析」的连接**必须**带 HAProxy 头；
#   · 没带就当成“协议错误”——直接移除探测器，不解码。
#
# ┌──────────────┬─────────────┬─────────────────────────────┐
# │ 组合场景     │ 谁有资格    │  自动/强制 说明             │
# ├──────────────┼─────────────┼─────────────────────────────┤
# │ 白+软+自开   │ 名单内      │ 自动嗅探；名单外不嗅探     │
# │ 白+软+自关   │ 名单内      │ 强制带头；名单外不嗅探     │
# │ 白+硬+自开   │ 名单内      │ 自动嗅探（名单外进不来）   │
# │ 白+硬+自关   │ 名单内      │ 强制带头（名单外进不来）   │
# │ 黑+自开      │ 名单外      │ 自动嗅探；名单内直接原始   │
# │ 黑+自关      │ 名单外      │ 强制带头；名单内直接原始   │
# └──────────────┴─────────────┴─────────────────────────────┘
# ------------------------------------------------------------------
auto-protocol-complete: true
